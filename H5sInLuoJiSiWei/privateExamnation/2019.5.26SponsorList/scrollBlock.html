<!doctype html>
<html>
	<head>
		<link rel="dns-prefetch" href="//staticcdn.igetget.com">
		<link rel="dns-prefetch" href="//staticcdn.luojilab.com">
		<link rel="dns-prefetch" href="//passport.luojilab.com">
		<link rel="dns-prefetch" href="//piccdn.luojilab.com">
		<meta name="MobileOptimized" content="320">
		<meta http-equiv="cleartype" content="on">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
	
		<meta name="format-detection" content="telephone=no, email=no">
		<meta name="msapplication-tap-highlight" content="no">
		<title>滚动模块</title>
		<style>
			.scroll-block {
				background-color: aqua;
				width: 100%;
				height: 500px;
				font-size: 18px;
			}
			.list{
				width: 100%;
				height: 400px;
				border: 1px solid #999;
				margin: 20px auto;
				position: relative;
				overflow: hidden;
			}
			.list .rowupleft{
				-webkit-animation: 6s rowupleft linear infinite normal;
				animation: 6s rowupleft linear infinite normal;
				position: relative;
				float: left;
				width: 49%;
			}
			.list .rowupright{
				-webkit-animation: 4s rowupright linear infinite normal;
				animation: 4s rowupright linear infinite normal;
				position: relative;
				float: right;
				width: 49%;
			}
			.item {

			}
		</style>
		<script type="text/javascript" src="js/libs/zepto-1.2.0.min.js"></script>
		<script type="text/javascript" src="js/libs/data.js"></script>

	</head>
	<body>
		<!-- 这一层是外框，指定宽度 -->
		<div class="scroll-block">
			<!-- 这一层是我的代码，指定高度即视区，宽度100% -->
			<div class="list">
				<!-- 这一层是移动层，有滚动效果，该层不断加载销毁新数据，上移 -->
				<div class="ccleft rowupleft">
					<!-- 这里边添加item一项项，一行行 -->
					<!-- 注意：每次添加数据要大一些，设计稿中没有行的概念，不对齐，原因是ss必须为一屏，重新开始对齐防止误差叠加 -->
				</div>
				<div class="ccright rowupright">
					<!-- 这里边添加item一项项，一行行 -->
					<!-- 注意：每次添加数据要大一些，设计稿中没有行的概念，不对齐，原因是ss必须为一屏，重新开始对齐防止误差叠加 -->
				</div>
			</div>
		</div>
	</body>
	<script type="text/javascript">
		// 动态编辑css 覆盖 transform
		function addKeyFramesright(height){
			var style = document.createElement('style');
			style.type = 'text/css';
			//关键帧，A_DYNAMIC_VALUE为每次加载的元素高度 单位px
			var keyFrames = '\
			@-webkit-keyframes rowupleft {\
				0% {\
					-webkit-transform: translate3d(0, 0, 0);\
					transform: translate3d(0, 0, 0);\
				}\
				100% {\
					-webkit-transform: translate3d(0, A_DYNAMIC_VALUE, 0);\
					transform: translate3d(0, A_DYNAMIC_VALUE, 0);\
				}\
			}\
			@keyframes rowupleft {\
				0% {\
					-webkit-transform: translate3d(0, 0, 0);\
					transform: translate3d(0, 0, 0);\
				}\
				100% {\
					-webkit-transform: translate3d(0, A_DYNAMIC_VALUE, 0);\
					transform: translate3d(0, A_DYNAMIC_VALUE, 0);\
				}\
			}\
			';
			style.innerHTML = keyFrames.replace(/A_DYNAMIC_VALUE/g, height);
			document.getElementsByTagName('head')[0].appendChild(style);
		}
		function addKeyFramesleft(height){
			var style = document.createElement('style');
			style.type = 'text/css';
			//关键帧，A_DYNAMIC_VALUE为每次加载的元素高度 单位px
			var keyFrames = '\
			@-webkit-keyframes rowupright {\
				0% {\
					-webkit-transform: translate3d(0, 0, 0);\
					transform: translate3d(0, 0, 0);\
				}\
				100% {\
					-webkit-transform: translate3d(0, A_DYNAMIC_VALUE, 0);\
					transform: translate3d(0, A_DYNAMIC_VALUE, 0);\
				}\
			}\
			@keyframes rowupright {\
				0% {\
					-webkit-transform: translate3d(0, 0, 0);\
					transform: translate3d(0, 0, 0);\
				}\
				100% {\
					-webkit-transform: translate3d(0, A_DYNAMIC_VALUE, 0);\
					transform: translate3d(0, A_DYNAMIC_VALUE, 0);\
				}\
			}\
			';
			style.innerHTML = keyFrames.replace(/A_DYNAMIC_VALUE/g, height);
			document.getElementsByTagName('head')[0].appendChild(style);
		}
		function init(){
			console.log(list);
			function initleft(){
				//左边的数据
				var data = '塞下秋来风景异，衡阳雁去无留意。四面边声连角起，千嶂里，长烟落日孤城闭。浊酒一杯家万里，燕然未勒归无计。羌管悠悠霜满地，人不寐，将军白发征夫泪。', //样例数据
					data_len = data.length,//数据的文字数
					len = parseInt(Math.random()*6)+6, // 数据的长度
					html = '<div class="ssleft">';
				
				for(var i=0; i<len; i++){
					var start = parseInt( Math.random()*(data_len-20) ),
						s = parseInt( Math.random()*data_len );
					html += '<div class="item">'+i+'- '+data.substr(start, s)+'</div>';
				}
				html += '</div>';
				document.querySelector('.list .ccleft').innerHTML = html+html; // 复制一份数据
				var height = document.querySelector('.list .ssleft').offsetHeight; // 一份数据的高度
				addKeyFramesright( '-'+height+'px' ); // 设置keyframes
				document.querySelector('.list .ccleft').className += ' rowupleft'; // 添加 rowup
			}					
			initleft();
			function initright(){
				//右边的数据
				var data = '羌管悠悠霜满地，人不寐，将军白发征夫泪。塞下秋来风景异，衡阳雁去无留意。四面边声连角起，千嶂里，长烟落日孤城闭。浊酒一杯家万里，燕然未勒归无计。', //样例数据
					data_len = data.length,//数据的文字数
					len = parseInt(Math.random()*6)+8, // 数据的长度
					html = '<div class="ssright">';
				
				for(var i=0; i<len; i++){
					var start = parseInt( Math.random()*(data_len-20) ),
						s = parseInt( Math.random()*data_len );
					html += '<div class="item">'+i+'- '+data.substr(start, s)+'</div>';
				}
				html += '</div>';
				document.querySelector('.list .ccright').innerHTML = html+html; // 复制一份数据
				var height = document.querySelector('.list .ssright').offsetHeight; // 一份数据的高度
				addKeyFramesleft( '-'+height+'px' ); // 设置keyframes
				document.querySelector('.list .ccright').className += ' rowupright'; // 添加 rowup
			}
			initright();
		}
		init(); 
	</script>
</html>
