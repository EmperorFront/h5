<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        div {
            display: inline-block;
            position: absolute;
            transform:translateZ(0);
        }
        body {
            padding:0;
            margin:0;
            overflow: hidden;
        }
        #screen {
            display: block;
            background-color:rgba(0,0,0,0);
            margin:auto;
            border:1px solid;
        }
        @keyframes theMove
        {
            35%   {left:380px; top:580px;}
            50%  {left:0px; top:0px;}
            75%  {left:780px; top:0px;}
            80% {left:0px; top:580px;}
        }
    </style>
    <title>缓存测试(缓存)</title>
</head>
<body>
<div >
    <div id='screen' width="800" height="600" style="width:800px; height: 600px; margin: 0 ; overflow: hidden"></div>
    <p style="text-align:center; display: inline-block; top: 650px; position: absolute; width: 600px;">在简单图形的情况下，css3动画，即使缓存也并没有太大的优化效果，是2000，由于消耗了更多资源，一会就开始卡了，GC大量触发 稳定在20fps</p>
</div>
<script src="../js/jquery-3.0.0.js"></script>
<script>
    //    var stats = new Stats();
    //    stats.setMode(0);
    //    stats.domElement.style.position = 'absolute';
    //    stats.domElement.style.right = '0px';
    //    stats.domElement.style.top = '0px';
    //    document.body.appendChild( stats.domElement );
    var data = [];
    function dataInit(){
        for (var i = 0; i < 2000; i++ ){
            var square = {
                r : getRandom(5,20),
                color : '#' + getRandom(99 , 999),
                vx : getRandom(5 , 20) ,
                vy : getRandom(-3 , 3)
            }
            data.push(square);
        }
    }
    function init(){
        dataInit();
        var html = '';
        for(i = 0; i < data.length; i++){
            html += '<div style="';
            html += ' top:'+ getRandom(1,600) + 'px; left:'+ getRandom(1,800) + 'px;';
            html += ' width:'+ data[i].r + 'px; height:'+ data[i].r + 'px; background-color:'+ data[i].color + ';';
            html += ' animation: theMove ' + getRandom(1,100) + 's linear 2s infinite alternate;';
            html += '"></div>';
        }
        $('#screen').html(html);
    }
    function getRandom(a , b){
        return getZ(Math.random()*(b-a)+a);
    }
    //一种牛逼的取整方式，比parseint代价小，parseint为处理浮点甚至转化了字符串
    function getZ(num){
        var rounded;
        rounded = (0.5 + num) | 0;
        // A double bitwise not.
        rounded = ~~ (0.5 + num);
        // Finally, a left bitwise shift.
        rounded = (0.5 + num) << 0;
        return rounded;
    }
    window.onload = function(){
        init();
    }
</script>
</body>
</html>